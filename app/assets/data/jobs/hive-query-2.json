{
  "starttime": 1394569191001,
  "otherinfo": {
    "query": "{\"queryText\":\"select c_last_name, c_first_name, ca_city, bought_city,\\n                                 ss_ticket_number, amt, profit\\n                          from (select ss_ticket_number,\\n                                       ss_customer_sk,\\n                                       ca_city as bought_city,\\n                                       sum(ss_coupon_amt) as amt,\\n                                       sum(ss_net_profit) as profit\\n                                from store_sales, date_dim, store, household_demographics, customer_address\\n                                where store_sales.ss_sold_date_sk = date_dim.d_date_sk\\n                                  and store_sales.ss_store_sk = store.s_store_sk\\n                                  and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\\n                                  and store_sales.ss_addr_sk = customer_address.ca_address_sk\\n                                  and (household_demographics.hd_dep_count = 4\\n                                       or household_demographics.hd_vehicle_count= 3)\\n                                  and date_dim.d_dow in (6,0)\\n                                  and date_dim.d_year in (1999, 1999+1, 1999+2)\\n                                  and store.s_city in ('Fairview', 'Fairview', 'Fairview', 'Midway', 'Fairview')\\n                                group by ss_ticket_number, ss_customer_sk, ss_addr_sk, ca_city) dn,\\n                                customer, customer_address current_addr\\n                          where dn.ss_customer_sk = customer.c_customer_sk\\n                            and customer.c_current_addr_sk = current_addr.ca_address_sk\\n                            and current_addr.ca_city <> dn.bought_city\\n                          order by c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number\\n                          limit 100\",\"queryPlan\":{\"STAGE PLANS\":{\"Stage-1\":{\"Tez\":{\"DagName:\":\"hrt_qa_20140311131919_1d932567-71c2-4341-9b50-6df1f58a9114:1\",\"Vertices:\":{\"Reducer 3\":{\"Reduce Operator Tree:\":{\"Group By Operator\":{\"mode:\":\"mergepartial\",\"aggregations:\":[\"sum(VALUE._col0)\",\"sum(VALUE._col1)\"],\"keys:\":\"KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int), KEY._col3 (type: string)\",\"outputColumnNames:\":[\"_col0\",\"_col1\",\"_col2\",\"_col3\",\"_col4\",\"_col5\"],\"children\":{\"Select Operator\":{\"expressions:\":\"_col0 (type: int), _col1 (type: int), _col3 (type: string), _col4 (type: decimal(17,2)), _col5 (type: decimal(17,2))\",\"outputColumnNames:\":[\"_col0\",\"_col1\",\"_col2\",\"_col3\",\"_col4\"],\"children\":{\"Reduce Output Operator\":{\"Map-reduce partition columns:\":\"_col1 (type: int)\",\"sort order:\":\"+\",\"value expressions:\":\"_col0 (type: int), _col1 (type: int), _col2 (type: string), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))\",\"Statistics:\":\"Num rows: 16473 Data size: 21775806 Basic stats: COMPLETE Column stats: NONE\",\"key expressions:\":\"_col1 (type: int)\"}},\"Statistics:\":\"Num rows: 16473 Data size: 21775806 Basic stats: COMPLETE Column stats: NONE\"}},\"Statistics:\":\"Num rows: 16473 Data size: 21775806 Basic stats: COMPLETE Column stats: NONE\"}}},\"Map 1\":{\"Execution mode:\":\"vectorized\",\"Map Operator Tree:\":[{\"TableScan\":{\"filterExpr:\":\"((hd_dep_count = 4) or (hd_vehicle_count = 3)) (type: boolean)\",\"alias:\":\"household_demographics\",\"children\":{\"Filter Operator\":{\"predicate:\":\"((hd_dep_count = 4) or (hd_vehicle_count = 3)) (type: boolean)\",\"children\":{\"Reduce Output Operator\":{\"Map-reduce partition columns:\":\"hd_demo_sk (type: int)\",\"sort order:\":\"+\",\"value expressions:\":\"hd_demo_sk (type: int), hd_dep_count (type: int), hd_vehicle_count (type: int)\",\"Statistics:\":\"Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE\",\"key expressions:\":\"hd_demo_sk (type: int)\"}},\"Statistics:\":\"Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE\"}},\"Statistics:\":\"Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE\"}}]},\"Map 2\":{\"Map Operator Tree:\":[{\"TableScan\":{\"alias:\":\"store_sales\",\"children\":{\"Map Join Operator\":{\"keys:\":{\"1\":\"d_date_sk (type: int)\",\"0\":\"ss_sold_date_sk (type: int)\"},\"outputColumnNames:\":[\"_col0\",\"_col3\",\"_col5\",\"_col6\",\"_col8\",\"_col18\",\"_col21\",\"_col22\",\"_col25\",\"_col31\",\"_col32\"],\"children\":{\"Map Join Operator\":{\"keys:\":{\"1\":\"UDFToDouble(s_store_sk) (type: double)\",\"0\":\"UDFToDouble(_col22) (type: double)\"},\"outputColumnNames:\":[\"_col0\",\"_col3\",\"_col5\",\"_col6\",\"_col8\",\"_col18\",\"_col21\",\"_col22\",\"_col25\",\"_col31\",\"_col32\",\"_col55\",\"_col77\"],\"children\":{\"Map Join Operator\":{\"keys:\":{\"1\":\"hd_demo_sk (type: int)\",\"0\":\"_col5 (type: int)\"},\"outputColumnNames:\":[\"_col0\",\"_col22\",\"_col31\",\"_col34\",\"_col36\",\"_col37\",\"_col39\",\"_col49\",\"_col52\",\"_col53\",\"_col56\",\"_col62\",\"_col63\",\"_col86\",\"_col89\",\"_col90\"],\"children\":{\"Map Join Operator\":{\"keys:\":{\"1\":\"ca_address_sk (type: int)\",\"0\":\"_col37 (type: int)\"},\"outputColumnNames:\":[\"_col0\",\"_col3\",\"_col4\",\"_col7\",\"_col29\",\"_col38\",\"_col41\",\"_col43\",\"_col44\",\"_col46\",\"_col56\",\"_col59\",\"_col60\",\"_col63\",\"_col69\",\"_col70\",\"_col93\",\"_col99\"],\"children\":{\"Filter Operator\":{\"predicate:\":\"((((((((_col38 = _col63) and (_col60 = _col7)) and (_col43 = _col0)) and (_col44 = _col93)) and ((_col3 = 4) or (_col4 = 3))) and (_col70) IN (6, 0)) and (_col69) IN (1999, (1999 + 1), (1999 + 2))) and (_col29) IN ('Fairview', 'Fairview', 'Fairview', 'Midway', 'Fairview')) (type: boolean)\",\"children\":{\"Select Operator\":{\"expressions:\":\"_col46 (type: int), _col41 (type: int), _col44 (type: int), _col99 (type: string), _col56 (type: decimal(7,2)), _col59 (type: decimal(7,2))\",\"outputColumnNames:\":[\"_col46\",\"_col41\",\"_col44\",\"_col99\",\"_col56\",\"_col59\"],\"children\":{\"Group By Operator\":{\"mode:\":\"hash\",\"aggregations:\":[\"sum(_col56)\",\"sum(_col59)\"],\"keys:\":\"_col46 (type: int), _col41 (type: int), _col44 (type: int), _col99 (type: string)\",\"outputColumnNames:\":[\"_col0\",\"_col1\",\"_col2\",\"_col3\",\"_col4\",\"_col5\"],\"children\":{\"Reduce Output Operator\":{\"Map-reduce partition columns:\":\"_col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: string)\",\"sort order:\":\"++++\",\"value expressions:\":\"_col4 (type: decimal(17,2)), _col5 (type: decimal(17,2))\",\"Statistics:\":\"Num rows: 32946 Data size: 43551613 Basic stats: COMPLETE Column stats: NONE\",\"key expressions:\":\"_col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: string)\"}},\"Statistics:\":\"Num rows: 32946 Data size: 43551613 Basic stats: COMPLETE Column stats: NONE\"}},\"Statistics:\":\"Num rows: 32946 Data size: 43551613 Basic stats: COMPLETE Column stats: NONE\"}},\"Statistics:\":\"Num rows: 32946 Data size: 43551613 Basic stats: COMPLETE Column stats: NONE\"}},\"Statistics:\":\"Num rows: 4217199 Data size: 5574753280 Basic stats: COMPLETE Column stats: NONE\",\"condition map:\":[{\"\":\"Inner Join 0 to 1\"}],\"condition expressions:\":{\"1\":\"{ca_address_sk} {ca_city}\",\"0\":\"{_col86} {_col89} {_col90} {_col0} {_col22} {_col31} {_col34} {_col36} {_col37} {_col39} {_col49} {_col52} {_col53} {_col56} {_col62} {_col63}\"}}},\"Statistics:\":\"Num rows: 3833817 Data size: 5067957248 Basic stats: COMPLETE Column stats: NONE\",\"condition map:\":[{\"\":\"Inner Join 0 to 1\"}],\"condition expressions:\":{\"1\":\"{hd_demo_sk} {hd_dep_count} {hd_vehicle_count}\",\"0\":\"{_col55} {_col77} {_col0} {_col3} {_col5} {_col6} {_col8} {_col18} {_col21} {_col22} {_col25} {_col31} {_col32}\"}}},\"Statistics:\":\"Num rows: 3485288 Data size: 4607233536 Basic stats: COMPLETE Column stats: NONE\",\"condition map:\":[{\"\":\"Inner Join 0 to 1\"}],\"condition expressions:\":{\"1\":\"{s_store_sk} {s_city}\",\"0\":\"{_col0} {_col3} {_col5} {_col6} {_col8} {_col18} {_col21} {_col22} {_col25} {_col31} {_col32}\"}}},\"Statistics:\":\"Num rows: 3168444 Data size: 4188394240 Basic stats: COMPLETE Column stats: NONE\",\"condition map:\":[{\"\":\"Inner Join 0 to 1\"}],\"condition expressions:\":{\"1\":\"{d_date_sk} {d_year} {d_dow}\",\"0\":\"{ss_sold_date_sk} {ss_customer_sk} {ss_hdemo_sk} {ss_addr_sk} {ss_ticket_number} {ss_coupon_amt} {ss_net_profit} {ss_store_sk}\"}}},\"Statistics:\":\"Num rows: 2880404 Data size: 3807631184 Basic stats: COMPLETE Column stats: NONE\"}}]},\"Map 5\":{\"Execution mode:\":\"vectorized\",\"Map Operator Tree:\":[{\"TableScan\":{\"alias:\":\"customer\",\"children\":{\"Map Join Operator\":{\"keys:\":{\"1\":\"c_customer_sk (type: int)\",\"0\":\"_col1 (type: int)\"},\"outputColumnNames:\":[\"_col0\",\"_col1\",\"_col2\",\"_col3\",\"_col4\",\"_col5\",\"_col9\",\"_col13\",\"_col14\"],\"children\":{\"Map Join Operator\":{\"keys:\":{\"1\":\"ca_address_sk (type: int)\",\"0\":\"_col9 (type: int)\"},\"outputColumnNames:\":[\"_col0\",\"_col1\",\"_col2\",\"_col3\",\"_col4\",\"_col5\",\"_col9\",\"_col13\",\"_col14\",\"_col25\",\"_col31\"],\"children\":{\"Filter Operator\":{\"predicate:\":\"(((_col1 = _col5) and (_col9 = _col25)) and (_col31 <> _col2)) (type: boolean)\",\"children\":{\"Select Operator\":{\"expressions:\":\"_col14 (type: string), _col13 (type: string), _col31 (type: string), _col2 (type: string), _col0 (type: int), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))\",\"outputColumnNames:\":[\"_col0\",\"_col1\",\"_col2\",\"_col3\",\"_col4\",\"_col5\",\"_col6\"],\"children\":{\"Reduce Output Operator\":{\"TopN Hash Memory Usage:\":\"0.04\",\"sort order:\":\"+++++\",\"value expressions:\":\"_col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int), _col5 (type: decimal(17,2)), _col6 (type: decimal(17,2))\",\"Statistics:\":\"Num rows: 30250 Data size: 25902518 Basic stats: COMPLETE Column stats: NONE\",\"key expressions:\":\"_col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int)\"}},\"Statistics:\":\"Num rows: 30250 Data size: 25902518 Basic stats: COMPLETE Column stats: NONE\"}},\"Statistics:\":\"Num rows: 30250 Data size: 25902518 Basic stats: COMPLETE Column stats: NONE\"}},\"Statistics:\":\"Num rows: 121000 Data size: 103610072 Basic stats: COMPLETE Column stats: NONE\",\"condition map:\":[{\"\":\"Inner Join 0 to 1\"}],\"condition expressions:\":{\"1\":\"{ca_address_sk} {ca_city}\",\"0\":\"{_col0} {_col1} {_col2} {_col3} {_col4} {_col5} {_col9} {_col13} {_col14}\"}}},\"Statistics:\":\"Num rows: 110000 Data size: 94190976 Basic stats: COMPLETE Column stats: NONE\",\"condition map:\":[{\"\":\"Inner Join 0 to 1\"}],\"condition expressions:\":{\"1\":\"{c_customer_sk} {c_current_addr_sk} {c_first_name} {c_last_name}\",\"0\":\"{_col0} {_col1} {_col2} {_col3} {_col4}\"}}},\"Statistics:\":\"Num rows: 100000 Data size: 85628164 Basic stats: COMPLETE Column stats: NONE\"}}]},\"Map 4\":{\"Map Operator Tree:\":[{\"TableScan\":{\"filterExpr:\":\"((d_dow) IN (6, 0) and (d_year) IN (1999, (1999 + 1), (1999 + 2))) (type: boolean)\",\"alias:\":\"date_dim\",\"children\":{\"Filter Operator\":{\"predicate:\":\"((d_dow) IN (6, 0) and (d_year) IN (1999, (1999 + 1), (1999 + 2))) (type: boolean)\",\"children\":{\"Reduce Output Operator\":{\"Map-reduce partition columns:\":\"d_date_sk (type: int)\",\"sort order:\":\"+\",\"value expressions:\":\"d_date_sk (type: int), d_year (type: int), d_dow (type: int)\",\"Statistics:\":\"Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE\",\"key expressions:\":\"d_date_sk (type: int)\"}},\"Statistics:\":\"Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE\"}},\"Statistics:\":\"Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE\"}}]},\"Map 7\":{\"Execution mode:\":\"vectorized\",\"Map Operator Tree:\":[{\"TableScan\":{\"alias:\":\"current_addr\",\"children\":{\"Reduce Output Operator\":{\"Map-reduce partition columns:\":\"ca_address_sk (type: int)\",\"sort order:\":\"+\",\"value expressions:\":\"ca_address_sk (type: int), ca_city (type: string)\",\"Statistics:\":\"Num rows: 50000 Data size: 55975728 Basic stats: COMPLETE Column stats: NONE\",\"key expressions:\":\"ca_address_sk (type: int)\"}},\"Statistics:\":\"Num rows: 50000 Data size: 55975728 Basic stats: COMPLETE Column stats: NONE\"}}]},\"Reducer 6\":{\"Reduce Operator Tree:\":{\"Extract\":{\"children\":{\"Limit\":{\"children\":{\"File Output Operator\":{\"Statistics:\":\"Num rows: 100 Data size: 85600 Basic stats: COMPLETE Column stats: NONE\",\"compressed:\":\"false\",\"table:\":{\"serde:\":\"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\",\"input format:\":\"org.apache.hadoop.mapred.TextInputFormat\",\"output format:\":\"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\"}}},\"Statistics:\":\"Num rows: 100 Data size: 85600 Basic stats: COMPLETE Column stats: NONE\",\"Number of rows:\":\"100\"}},\"Statistics:\":\"Num rows: 30250 Data size: 25902518 Basic stats: COMPLETE Column stats: NONE\"}}},\"Map 9\":{\"Execution mode:\":\"vectorized\",\"Map Operator Tree:\":[{\"TableScan\":{\"filterExpr:\":\"(s_city) IN ('Fairview', 'Fairview', 'Fairview', 'Midway', 'Fairview') (type: boolean)\",\"alias:\":\"store\",\"children\":{\"Filter Operator\":{\"predicate:\":\"(s_city) IN ('Fairview', 'Fairview', 'Fairview', 'Midway', 'Fairview') (type: boolean)\",\"children\":{\"Reduce Output Operator\":{\"Map-reduce partition columns:\":\"UDFToDouble(s_store_sk) (type: double)\",\"sort order:\":\"+\",\"value expressions:\":\"s_store_sk (type: int), s_city (type: string)\",\"Statistics:\":\"Num rows: 6 Data size: 12816 Basic stats: COMPLETE Column stats: NONE\",\"key expressions:\":\"UDFToDouble(s_store_sk) (type: double)\"}},\"Statistics:\":\"Num rows: 6 Data size: 12816 Basic stats: COMPLETE Column stats: NONE\"}},\"Statistics:\":\"Num rows: 12 Data size: 25632 Basic stats: COMPLETE Column stats: NONE\"}}]},\"Map 8\":{\"Execution mode:\":\"vectorized\",\"Map Operator Tree:\":[{\"TableScan\":{\"alias:\":\"customer_address\",\"children\":{\"Reduce Output Operator\":{\"Map-reduce partition columns:\":\"ca_address_sk (type: int)\",\"sort order:\":\"+\",\"value expressions:\":\"ca_address_sk (type: int), ca_city (type: string)\",\"Statistics:\":\"Num rows: 50000 Data size: 55975728 Basic stats: COMPLETE Column stats: NONE\",\"key expressions:\":\"ca_address_sk (type: int)\"}},\"Statistics:\":\"Num rows: 50000 Data size: 55975728 Basic stats: COMPLETE Column stats: NONE\"}}]}},\"Edges:\":{\"Reducer 3\":{\"parent\":\"Map 2\",\"type\":\"SIMPLE_EDGE\"},\"Map 2\":[{\"parent\":\"Map 1\",\"type\":\"BROADCAST_EDGE\"},{\"parent\":\"Map 4\",\"type\":\"BROADCAST_EDGE\"},{\"parent\":\"Map 8\",\"type\":\"BROADCAST_EDGE\"},{\"parent\":\"Map 9\",\"type\":\"BROADCAST_EDGE\"}],\"Map 5\":[{\"parent\":\"Reducer 3\",\"type\":\"BROADCAST_EDGE\"},{\"parent\":\"Map 7\",\"type\":\"BROADCAST_EDGE\"}],\"Reducer 6\":{\"parent\":\"Map 5\",\"type\":\"SIMPLE_EDGE\"}}}},\"Stage-0\":{\"Fetch Operator\":{\"limit:\":\"100\",\"Processor Tree:\":{\"ListSink\":{}}}}},\"STAGE DEPENDENCIES\":{\"Stage-1\":{\"ROOT STAGE\":\"TRUE\"},\"Stage-0\":{\"ROOT STAGE\":\"TRUE\"}}}}"
  },
  "entity": "hrt_qa_20140311131919_1d932567-71c2-4341-9b50-6df1f58a9114",
  "entitytype": "HIVE_QUERY_ID"
}